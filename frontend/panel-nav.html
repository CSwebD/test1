<nav class="fixed top-0 w-full bg-white/80 backdrop-blur-md shadow-sm z-50">
  <div class="max-w-7xl mx-auto flex items-center justify-between px-6 py-4">
    <a href="index.html" class="text-2xl font-bold text-green-700 hover:text-green-800 transition">Skill Maps</a>

    <!-- Mobile menu toggle -->
    <button id="navToggle" class="sm:hidden text-gray-800 focus:outline-none">
      <i class="fas fa-bars fa-xl"></i>
    </button>

    <!-- Desktop navigation -->
    <div class="hidden sm:flex items-center space-x-6">
      <div id="navLinks" class="flex items-center space-x-8 text-sm">
        <a href="index.html" class="hover:text-green-700">Home</a>
        <a href="domains.html" class="hover:text-green-700">Domains</a>
        <a href="skills.html" class="hover:text-green-700">Skill Maps</a>
        <a href="ai.html" class="hover:text-green-700">AI</a>
        <a href="blog.html" class="hover:text-green-700">Blog</a>
        <a href="FAQs.html" class="hover:text-green-700">FAQ</a>
      </div>

      <!-- Auth buttons (desktop) -->
      <div id="authButtons" class="flex items-center space-x-3">
        <a href="login.html" class="px-4 py-2 text-sm text-green-700 hover:text-green-800 font-medium transition">Login</a>
        <a href="signup.html" class="px-4 py-2 text-sm bg-green-700 text-white rounded-lg hover:bg-green-800 transition">Sign Up</a>
      </div>

      <!-- User menu (desktop - hidden by default) -->
      <div id="userMenu" class="hidden items-center space-x-4">
        <div class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-green-700 rounded-full flex items-center justify-center text-white text-sm font-bold" id="userAvatar">
            U
          </div>
          <span class="text-sm font-medium text-gray-700" id="userName">User</span>
        </div>
        <button onclick="handleLogout()" class="px-4 py-2 text-sm text-red-600 hover:text-red-700 font-medium transition">
          Logout
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile menu -->
  <div id="mobileMenu" class="sm:hidden hidden bg-white shadow-inner">
    <a href="index.html" class="block px-6 py-3 hover:bg-gray-100">Home</a>
    <a href="domains.html" class="block px-6 py-3 hover:bg-gray-100">Domains</a>
    <a href="skills.html" class="block px-6 py-3 hover:bg-gray-100">Skill Maps</a>
    <a href="ai.html" class="block px-6 py-3 hover:bg-gray-100">AI</a>
    <a href="blog.html" class="block px-6 py-3 hover:bg-gray-100">Blog</a>
    <a href="FAQs.html" class="block px-6 py-3 hover:bg-gray-100">FAQ</a>
    
    <!-- Mobile auth section -->
    <div id="mobileAuthButtons" class="border-t border-gray-200 px-6 py-3 space-y-2">
      <a href="login.html" class="block w-full text-center px-4 py-2 text-sm text-green-700 hover:bg-gray-100 rounded">Login</a>
      <a href="signup.html" class="block w-full text-center px-4 py-2 text-sm bg-green-700 text-white rounded hover:bg-green-800">Sign Up</a>
    </div>

    <!-- Mobile user menu (hidden by default) -->
    <div id="mobileUserMenu" class="hidden border-t border-gray-200 px-6 py-3">
      <div class="flex items-center space-x-3 mb-3">
        <div class="w-10 h-10 bg-green-700 rounded-full flex items-center justify-center text-white font-bold" id="mobileUserAvatar">
          U
        </div>
        <span class="text-sm font-medium text-gray-700" id="mobileUserName">User</span>
      </div>
      <button onclick="handleLogout()" class="w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded font-medium transition">
        Logout
      </button>
    </div>
  </div>
</nav>

<!-- JavaScript for navigation and auth -->
<script>
  // Configuration
  const API_URL = 'http://localhost:3000'; // Update with your backend URL

  // Mobile menu toggle
  document.addEventListener('DOMContentLoaded', () => {
    const navToggle = document.getElementById('navToggle');
    const mobileMenu = document.getElementById('mobileMenu');

    navToggle.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });

    // Initialize auth state
    updateAuthUI();
  });

  // Check if user is logged in
  function isLoggedIn() {
    return localStorage.getItem('authToken') !== null;
  }

  // Get current user
  function getCurrentUser() {
    const userStr = localStorage.getItem('user');
    return userStr ? JSON.parse(userStr) : null;
  }

  // Update UI based on auth state
  function updateAuthUI() {
    const authButtons = document.getElementById('authButtons');
    const userMenu = document.getElementById('userMenu');
    const mobileAuthButtons = document.getElementById('mobileAuthButtons');
    const mobileUserMenu = document.getElementById('mobileUserMenu');

    if (isLoggedIn()) {
      const user = getCurrentUser();
      
      // Desktop
      authButtons.classList.add('hidden');
      userMenu.classList.remove('hidden');
      userMenu.classList.add('flex');
      
      // Mobile
      mobileAuthButtons.classList.add('hidden');
      mobileUserMenu.classList.remove('hidden');

      // Update user info
      const initial = user.username.charAt(0).toUpperCase();
      document.getElementById('userAvatar').textContent = initial;
      document.getElementById('userName').textContent = user.username;
      document.getElementById('mobileUserAvatar').textContent = initial;
      document.getElementById('mobileUserName').textContent = user.username;
    } else {
      // Desktop
      authButtons.classList.remove('hidden');
      userMenu.classList.add('hidden');
      
      // Mobile
      mobileAuthButtons.classList.remove('hidden');
      mobileUserMenu.classList.add('hidden');
    }
  }

  // Logout function
  async function handleLogout() {
    const token = localStorage.getItem('authToken');
    
    if (token) {
      try {
        await fetch(`${API_URL}/api/logout`, {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`,
          },
        });
      } catch (error) {
        console.error('Logout error:', error);
      }
    }
    
    localStorage.removeItem('authToken');
    localStorage.removeItem('user');
    
    // Update UI
    updateAuthUI();
    
    // Optionally redirect to home
    if (window.location.pathname !== '/index.html' && window.location.pathname !== '/') {
      window.location.href = 'index.html';
    }
  }

  // Make authenticatedFetch available globally
  async function authenticatedFetch(url, options = {}) {
    const token = localStorage.getItem('authToken');
    
    if (!token) {
      window.location.href = 'login.html';
      return;
    }
    
    const headers = {
      ...options.headers,
      'Authorization': `Bearer ${token}`,
    };
    
    try {
      const response = await fetch(url, { ...options, headers });
      
      if (response.status === 401) {
        // Token expired or invalid
        localStorage.removeItem('authToken');
        localStorage.removeItem('user');
        window.location.href = 'login.html';
        return;
      }
      
      return response;
    } catch (error) {
      console.error('Request error:', error);
      throw error;
    }
  }

  // Protect pages that require authentication
  function requireAuth() {
    if (!isLoggedIn()) {
      window.location.href = 'login.html';
    }
  }

  // Export auth functions globally
  window.auth = {
    isLoggedIn,
    getCurrentUser,
    logout: handleLogout,
    authenticatedFetch,
    requireAuth,
    updateAuthUI
  };
</script>